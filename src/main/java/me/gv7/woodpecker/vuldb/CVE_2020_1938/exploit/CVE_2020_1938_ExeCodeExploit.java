package me.gv7.woodpecker.vuldb.CVE_2020_1938.exploit;

import me.gv7.woodpecker.plugin.*;
import me.gv7.woodpecker.vuldb.CVE_2017_12615.CVE_2017_12615_Plugin;
import me.gv7.woodpecker.vuldb.CVE_2020_1938.CVE_2020_1938_Plugin;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class CVE_2020_1938_ExeCodeExploit implements IExploit {
    public String getExploitTabCaption() {
        return "Exec Code";
    }

    public IArgsUsageBinder getExploitCustomArgs() {
        IArgsUsageBinder argsUsageBinder = CVE_2020_1938_Plugin.pluginHelper.createArgsUsageBinder();
        List<IArg> args = new ArrayList<IArg>();
        final IArg request_path = CVE_2020_1938_Plugin.pluginHelper.createArg();
        request_path.setName("request_path");
        request_path.setDefaultValue("/docs/favicon.ico");
        request_path.setRequired(true);
        request_path.setDescription("要读的文件");
        args.add(request_path);

        final IArg request_uri = CVE_2017_12615_Plugin.pluginHelper.createArg();
        request_uri.setName("javax.servlet.include.request_uri");
        request_uri.setDefaultValue("/");
        request_uri.setRequired(true);
        request_uri.setDescription("");
        args.add(request_uri);

        final IArg path_info = CVE_2017_12615_Plugin.pluginHelper.createArg();
        path_info.setName("javax.servlet.include.path_info");
        path_info.setDefaultValue("/WEB-INF/web.xml");
        path_info.setRequired(true);
        path_info.setDescription("");
        args.add(path_info);

        final IArg servlet_path = CVE_2017_12615_Plugin.pluginHelper.createArg();
        servlet_path.setName("javax.servlet.include.servlet_path");
        servlet_path.setDefaultValue("/");
        servlet_path.setRequired(true);
        servlet_path.setDescription("");
        args.add(servlet_path);

        argsUsageBinder.setArgsList(args);
        return argsUsageBinder;
    }

    public void doExploit(ITarget target, Map<String, Object> customArgs, IResultOutput resultOutput) {
        resultOutput.infoPrintln("info");
        resultOutput.errorPrintln("err");
        resultOutput.rawPrintln("raw");
        resultOutput.successPrintln("success");
        resultOutput.failPrintln("fail");
        resultOutput.debugPrintln("debug");
        resultOutput.warningPrintln("warning");
    }
}
